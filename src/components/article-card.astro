---
// -- article card component for news items
import { Clock, ArrowUpRight, Tag } from 'lucide-astro';

interface Props {
  slug: string;
  title: string;
  excerpt: string;
  category: string;
  publishedAt: string;
  readingTime?: number;
  imageUrl?: string;
  featured?: boolean;
}

const {
  slug,
  title,
  excerpt,
  category,
  publishedAt,
  readingTime = 5,
  imageUrl = '/placeholder-article.jpg',
  featured = false,
} = Astro.props;

// -- format date for display
const formatDate = (dateString: string) => {
  const date = new Date(dateString);
  return date.toLocaleDateString('en-US', {
    month: 'short',
    day: 'numeric',
    year: 'numeric',
  });
};

// -- generate category color class
const getCategoryColor = (cat: string) => {
  const colors: Record<string, string> = {
    technology: 'category-tech',
    science: 'category-science',
    business: 'category-business',
    culture: 'category-culture',
    default: 'category-default',
  };
  return colors[cat.toLowerCase()] || colors.default;
};
---

<article class:list={['article-card', { 'article-card-featured': featured }]}>
  <a href={`/news/${slug}`} class="card-link" aria-label={`Read article: ${title}`}>
    <!-- -- card image -->
    <div class="card-image-wrapper">
      <img 
        src={imageUrl} 
        alt=""
        class="card-image"
        loading="lazy"
        decoding="async"
      />
      <div class="card-image-overlay" aria-hidden="true"></div>
    </div>
    
    <!-- -- card content -->
    <div class="card-content">
      <!-- -- card meta -->
      <div class="card-meta">
        <span class:list={['card-category', getCategoryColor(category)]}>
          <Tag size={12} strokeWidth={2} />
          {category}
        </span>
        <div class="card-meta-right">
          <span class="card-date">{formatDate(publishedAt)}</span>
          <span class="card-reading-time">
            <Clock size={12} strokeWidth={2} />
            {readingTime} min
          </span>
        </div>
      </div>
      
      <!-- -- card title -->
      <h3 class="card-title">{title}</h3>
      
      <!-- -- card excerpt -->
      <p class="card-excerpt">{excerpt}</p>
      
      <!-- -- card action -->
      <div class="card-action">
        <span class="action-text">Read Article</span>
        <ArrowUpRight size={16} strokeWidth={2} class="action-icon" />
      </div>
    </div>
  </a>
</article>

<style>
  /* -- article card styles */
  .article-card {
    background-color: var(--color-bg-card);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    overflow: hidden;
    transition: all var(--transition-base);
  }
  
  .article-card:hover {
    border-color: var(--color-border-hover);
    transform: translateY(-6px);
    box-shadow: var(--shadow-xl);
  }
  
  .card-link {
    display: flex;
    flex-direction: column;
    height: 100%;
    color: inherit;
    text-decoration: none;
  }
  
  /* -- card image */
  .card-image-wrapper {
    position: relative;
    aspect-ratio: 16 / 9;
    overflow: hidden;
  }
  
  .card-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform var(--transition-slow);
  }
  
  .article-card:hover .card-image {
    transform: scale(1.08);
  }
  
  .card-image-overlay {
    position: absolute;
    inset: 0;
    background: linear-gradient(
      to bottom,
      transparent 0%,
      rgba(10, 10, 11, 0.3) 100%
    );
    opacity: 0;
    transition: opacity var(--transition-base);
  }
  
  .article-card:hover .card-image-overlay {
    opacity: 1;
  }
  
  /* -- card content */
  .card-content {
    display: flex;
    flex-direction: column;
    flex: 1;
    padding: var(--space-lg);
    gap: var(--space-sm);
  }
  
  /* -- card meta */
  .card-meta {
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: var(--space-sm);
  }
  
  .card-category {
    display: inline-flex;
    align-items: center;
    gap: var(--space-xs);
    padding: var(--space-xs) var(--space-sm);
    border-radius: var(--radius-sm);
    font-size: var(--text-xs);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }
  
  .category-tech {
    background-color: rgba(46, 196, 182, 0.15);
    color: var(--color-accent-tertiary);
  }
  
  .category-science {
    background-color: rgba(139, 92, 246, 0.15);
    color: #8b5cf6;
  }
  
  .category-business {
    background-color: rgba(255, 107, 53, 0.15);
    color: var(--color-accent-primary);
  }
  
  .category-culture {
    background-color: rgba(236, 72, 153, 0.15);
    color: #ec4899;
  }
  
  .category-default {
    background-color: var(--color-bg-tertiary);
    color: var(--color-text-secondary);
  }
  
  .card-meta-right {
    display: flex;
    align-items: center;
    gap: var(--space-md);
  }
  
  .card-date,
  .card-reading-time {
    display: flex;
    align-items: center;
    gap: var(--space-xs);
    color: var(--color-text-muted);
    font-size: var(--text-xs);
  }
  
  /* -- card title */
  .card-title {
    font-family: var(--font-display);
    font-size: var(--text-xl);
    font-weight: 600;
    line-height: 1.3;
    color: var(--color-text-primary);
    transition: color var(--transition-fast);
  }
  
  .article-card:hover .card-title {
    color: var(--color-accent-primary);
  }
  
  /* -- card excerpt */
  .card-excerpt {
    flex: 1;
    color: var(--color-text-secondary);
    font-size: var(--text-sm);
    line-height: 1.6;
    margin: 0;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  /* -- card action */
  .card-action {
    display: flex;
    align-items: center;
    gap: var(--space-xs);
    margin-top: var(--space-sm);
    color: var(--color-accent-primary);
    font-size: var(--text-sm);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }
  
  .action-icon {
    transition: transform var(--transition-fast);
  }
  
  .article-card:hover .action-icon {
    transform: translate(4px, -4px);
  }
  
  /* -- featured card variant */
  .article-card-featured {
    grid-column: span 2;
  }
  
  .article-card-featured .card-link {
    flex-direction: row;
  }
  
  .article-card-featured .card-image-wrapper {
    width: 50%;
    aspect-ratio: auto;
  }
  
  .article-card-featured .card-content {
    width: 50%;
    justify-content: center;
    padding: var(--space-xl);
  }
  
  .article-card-featured .card-title {
    font-size: var(--text-2xl);
  }
  
  .article-card-featured .card-excerpt {
    font-size: var(--text-base);
    -webkit-line-clamp: 4;
  }
  
  @media (max-width: 768px) {
    .article-card-featured {
      grid-column: span 1;
    }
    
    .article-card-featured .card-link {
      flex-direction: column;
    }
    
    .article-card-featured .card-image-wrapper,
    .article-card-featured .card-content {
      width: 100%;
    }
    
    .article-card-featured .card-image-wrapper {
      aspect-ratio: 16 / 9;
    }
    
    .article-card-featured .card-title {
      font-size: var(--text-xl);
    }
  }
</style>
