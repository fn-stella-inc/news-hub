---
// -- news listing page - light theme
import BaseLayout from '../../layouts/base-layout.astro';
import Navbar from '../../components/navbar.astro';
import Footer from '../../components/footer.astro';
import NewsList from '../../components/news-list.astro';
import CategoryFilter from '../../components/category-filter.astro';
import { getPaginatedArticles, getCategoryInfo } from '../../lib/articles';

// -- get category from url query
const url = new URL(Astro.request.url);
const category = url.searchParams.get('category') || 'all';

// -- get initial articles
const { articles, hasMore } = getPaginatedArticles(1, 6, category);

// -- get category info for display
const categoryInfo = getCategoryInfo(category);

// -- page metadata based on category
const categoryTitles: Record<string, string> = {
  all: 'All News',
  technology: 'Technology',
  topics: 'Topics & Trends',
  science: 'Science',
  business: 'Business',
  culture: 'Culture',
};

const pageTitle = categoryTitles[category] || 'News';
const pageDescription = categoryInfo?.description || 
  `Browse the latest ${category === 'all' ? '' : category + ' '}news and updates. AI-curated content covering diverse topics and perspectives.`;
---

<BaseLayout 
  title={pageTitle}
  description={pageDescription}
  keywords={['news', category, 'articles', 'updates', 'latest']}
  ogType="website"
>
  <Navbar />
  
  <main id="main-content" class="news-page">
    <div class="container">
      <!-- -- page header -->
      <header class="page-header">
        <h1 class="page-title">
          {category === 'all' ? (
            <span>All <span class="title-gradient">News</span></span>
          ) : (
            <span class="title-gradient">{pageTitle}</span>
          )}
        </h1>
        <p class="page-description">
          {pageDescription}
        </p>
      </header>
      
      <!-- -- category filter -->
      <CategoryFilter activeCategory={category} />
      
      <!-- -- news list -->
      <NewsList 
        articles={articles} 
        category={category}
        showLoadMore={hasMore}
      />
    </div>
  </main>
  
  <Footer />
</BaseLayout>

<style>
  /* -- news page styles - light theme */
  .news-page {
    padding: var(--space-2xl) 0 var(--space-3xl);
    min-height: calc(100vh - 200px);
  }
  
  .page-header {
    margin-bottom: var(--space-2xl);
    text-align: center;
  }
  
  .page-title {
    font-family: var(--font-display);
    font-size: var(--text-4xl);
    font-weight: 800;
    color: var(--color-text-primary);
    margin-bottom: var(--space-sm);
    animation: fade-in 0.6s ease forwards;
  }
  
  .title-gradient {
    background: linear-gradient(135deg, #dd0cf0 0%, #7c3aed 40%, #22d3ee 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
  
  .page-description {
    font-size: var(--text-lg);
    color: var(--color-text-secondary);
    max-width: 600px;
    margin: 0 auto;
    animation: fade-in 0.6s ease 0.1s forwards;
    opacity: 0;
  }
  
  @media (max-width: 768px) {
    .page-title {
      font-size: var(--text-3xl);
    }
    
    .page-description {
      font-size: var(--text-base);
    }
  }
</style>
